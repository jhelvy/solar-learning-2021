---
output:
  github_document:
    html_preview: false
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r setup, echo=FALSE}
IS_README <- TRUE
```

Repository to reproduce results from our study on global versus national learning rates in the solar PV industry.

# Folder descriptions

## `/data`

file or folder | description
-----|--------------------------------
`raw` | A folder containing all of the "raw" data
`formatted.Rds` | A list object containing data frames of formatted data; generated by running the script at `code/2format_data.R`
`raw_data_sources.md` | A description of all the raw data

## `/code`

file or folder | description
-----|--------------------------------
`0functions.R` | Custom functions
`0setup.R` | Loads libraries, creates `dir` object (a list of paths to folders and objects), and loads `0functions.R`
`1digitize_plots.R` | Code to extract data from some image files in the `data/raw` folder
`2format_data.R` | Formats and harmonizes all raw data and saves the result as the list object at `data/formatted.Rds`
`3compare_us_data.R` | Some quick checks to compare the NREL and SEIA/LBNL data for the US. We decided to use the SEIA/LBNL data for our analyses
`4learning_curves.R` | Estimates all learning curve models and saves all results as the list object at `output/lr_models.Rds`
`5cost_scenarios.R` | Uses the estimates learning curves models to compute differences in historical costs under different scenarios. Results are saved as the list object at `output/cost_scenarios.Rds`
`6charts.R` | All charts

## `/figs`

All charts created in the `code/6charts.R` file are saved here as pdfs and pngs.

# Reproducing the analyses

## Setup

Most R files in the `/code` folder start with the following line:

```{r, warning=FALSE, message=FALSE}
source(here::here('code', '0setup.R'))
```

This loads all the libraries we use as well as custom functions in the `/code/0functions.R` file. It also creates a list called `dir` which stores paths to commonly accessed folders and files.
 
## Formatting the data

All of the raw data are stored in the `/data/raw` folder. The script at `/code/2format_data.R` formats all of this data and saves it as a list stored at `/code/formatted.Rds`.

To load this list of formatted data, run this line after sourcing the `/code/0setup.R` file:

```{r, eval=FALSE}
data <- readRDS(dir$data_formatted)

# Names of the formatted data frames:
names(data)
```

## Learning curve models

All of the learning curve models are estimated by running the `/code/4learning_curves.R` file. Results are saved in a list of data frames containing formatted model results stored in `/output/lr_models.Rds`.

To load formatted results, run this line:

```{r, eval=FALSE}
lr <- readRDS(dir$lr_models)

# Names of the LR models:
names(lr)
```

## Cost scenarios

All of the cost scenario calculations are computed by running the `/code/5cost_scenarios.R` file. Results are saved in a list of data frame containing formatted results stored in `/output/cost_scenarios.Rds`.

To load the results of the cost scenarios, run this line:

```{r, eval=FALSE}
cost <- readRDS(dir$cost_scenarios)

# Names of the cost scenarios:
names(cost)
```

## Charts

All of the charts are generated by running the `/code/6charts.R` file. Results are saved as pngs and pdfs in the `/figs` folder.
