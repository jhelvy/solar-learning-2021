
<!-- README.md is generated from README.Rmd. Please edit that file -->

This repository contains the data and code to reproduce results from our
study on global versus national learning rates in the solar PV industry.

# Folder descriptions

## data

Contains all of the “raw” data used in our analyses as well as a single
`formatted.Rds` file that when loaded into R is a list of formatted data
frames, which is generated by running the script at
`code/2format_data.R`.

## code

| file or folder            | description                                                                                                                                                                                      |
|---------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `0a_run.R`                | A single file to reproduce all analyses.                                                                                                                                                         |
| `0functions.R`            | Custom functions used in our analyses.                                                                                                                                                           |
| `0setup.R`                | Loads libraries, creates `dir` object (a list of paths to folders and objects), and loads `0functions.R`.                                                                                        |
| `1format_data.R`          | Formats and harmonizes all raw data and saves the result as the list object at `data/formatted.Rds`.                                                                                             |
| `2learning_curves.R`      | Estimates learning curve models and saves all results as the list object at `output/lr_models.Rds`.                                                                                              |
| `3historical_scenarios.R` | Uses the estimates learning curves models to compute differences in historical costs under different scenarios. Results are saved as the list object at `output/historical_scenarios.Rds`.       |
| `4projection_scenarios.R` | Uses the estimates learning curves models to compute differences in projected future costs under different scenarios. Results are saved as the list object at `output/projection_scenarios.Rds`. |
| `5charts.R`               | Code to reproduce all charts used in our analyses.                                                                                                                                               |
| `6summary.R`              | Code to print out a summary of all main results.                                                                                                                                                 |
| `7sensitivity.R`          | Several sensitivity analyses. Compares differences in the raw cost and capacity data used for the U.S. as well as sensitivities to different 2020 starting prices on the projected prices.       |
| `8tables.Rmd`             | Generates all tables in the `output/tables.docx` file.                                                                                                                                           |

## figs

All charts created in the `code/5charts.R` file are saved here as pdfs
and pngs.

## output

All model / scenario analyses outputs (other than charts) are saved
here.

# Reproducing the analyses

To reproduce the analyses, first open the `solar-learning-2021.Rproj`
file, which sets the working directory to the root of the files in this
repository. The repository root must be set as the working directory
otherwise the code will error.

## Full reproduction

The `code/0a_run.R` file contains scripts to fully reproduce the entire
set of analyses. This is here purely for convenience.

## Setup

Most R files in the `/code` folder start with the following line to set
up the working environment:

``` r
source(here::here('code', '0setup.R'))
```

## Formatting the data

All of the raw data are stored in the `/data` folder. The script at
`/code/1format_data.R` formats all of this data and saves it as a list
stored at `/data/formatted.Rds`.

To load this list of formatted data, run this line after sourcing the
`/code/0setup.R` file:

``` r
data <- readRDS(dir$data_formatted)

# Names of the formatted data frames:
names(data)
```

    ##  [1] "pvProduction"       "irenaCumCapacityMw" "nrelCapacity"      
    ##  [4] "nrelCost"           "seiaCapacity"       "lbnlCost"          
    ##  [7] "usNrel"             "us"                 "china"             
    ## [10] "germany"            "world"              "proj_nat_trends"   
    ## [13] "proj_sus_dev"

## Learning curve models

All of the learning curve models are estimated by running the
`/code/2learning_curves.R` file. Results are saved in a list of data
frames containing formatted model results stored in
`/output/lr_models.Rds`.

To load formatted results, run this line:

``` r
lr <- readRDS(dir$lr_models)

# Names of the LR models:
names(lr)
```

## Historical scenarios

All of the historical (2008 - 2018) cost scenario calculations are
computed by running the `/code/3historical_scenarios.R` file. Results
are saved in a list of data frame containing formatted results stored in
`/output/historical_scenarios.Rds`.

To load the results of the historical scenarios, run this line:

``` r
cost <- readRDS(dir$historical_scenarios)

# Names of the scenarios:
names(cost)
```

    ## [1] "cost_historical_true" "cost"                 "savings"

## Projected scenarios

All of the future projected (2018 - 2030) cost scenario calculations are
computed by running the `/code/4projection_scenarios.R` file. Results
are saved in a list of data frame containing formatted results stored in
`/output/projection_scenarios.Rds`.

To load the results of the projected scenarios, run this line:

``` r
proj <- readRDS(dir$projection_scenarios)

# Names of the scenarios:
names(proj)
```

    ## [1] "year"           "cost_per_kw"    "cost_per_kw_lb" "cost_per_kw_ub"
    ## [5] "country"        "learning"       "scenario"

## Charts

All of the charts are generated by running the `/code/5charts.R` file.
Results are saved as pngs and pdfs in the `/figs` folder.
